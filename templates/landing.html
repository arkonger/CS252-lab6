<!DOCTYPE html>
<html>
  <head>
    <title>ResHost</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <h1>ResHost 1.0</h1>
  
    <hr>
  
    <div id="content">
      <form id="login" method="post" style="display: inline-block"
        width="20%" height="25%" enctype="multipart/form-data">
        <input type="text" id="uname" placeholder="Username"><br>
        <input type="text" id="pword" placeholder="Password"><br>
        <input type="submit" name="submit" value="Login"><br>
        <a href="create-account">Create an account.</a><br>
      </form>
    </div>
    
    <hr>

    <div id="pdfs">
      <u><a class="name" id="name1">Hello World</a></u><br>
      <div id="name1div" style="display: none">
        <p style="text-align: left">Description</p>
        <embed class="pdf" width="90%" id="name1pdf" type="application/pdf" src="Hello World.pdf"><br>
      </div>
    </div>
  
    <script>
      $(".name").click(function ()
      {
        var id = this.id + "div";
        var state = document.getElementById(id).style.display;
        if (state == "none")
        {
          document.getElementById(id).style.display = "block";
        }
        else document.getElementById(id).style.display = "none";
      });

      $(".pdf").height($(document).height()*.9);

      $("#login").submit(function (e)
      {
        var host = "http://69.174.137.112:5397";
        e.preventDefault();

        var uname = document.getElementById("uname").value,
          pword = document.getElementById("pword").value;

        if (uname == "" ||
          pword == "")
        {
          alert("Required field is blank!");
          return;
        }
        
        var post = $.post(host + "/login", {username: uname,
          password: pword});
        post.done(function (data)
        {
          $("#content").empty().append(data);
          $("#content").find("#uploadcontent").prepend(
            "Upload a different file:");
        });
      });
      
      //TODO: add js for user actions
      $("#content").on('submit', '#uploadcontent', function (e)
      {
        alert("oh boy-o");
        //The file to upload
        var file = document.getElementById("pdfbox").files[0];
        //A FileReader to get the file contents
        var reader = new FileReader();
        reader.onload = function ()
        {
          console.log(reader.result);
        }
        reader.readAsBinaryString(file);

        var post = $.post(host + "/upload", {username: username,
          filename: file.name, filesize: file.size, file: reader.result});
        post.done(function (data)
        {
          e.preventDefault();
          alert("donzo");
          //var ret = $(data).find("#content");
          //$("#content").empty().append(data);
        });
      });
    </script>
  </body>
</html>
